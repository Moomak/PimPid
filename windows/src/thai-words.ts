/**
 * รายการคำไทยที่ถือว่าเป็นคำที่ตั้งใจพิมพ์ — ไม่แปลงเป็นอังกฤษ
 * Port จาก ThaiWordList.swift
 */

const embeddedWords: string[] = [
  "ประเทศ", "เทศ", "รัก", "ช่วย", "ประ", "เจอ", "ครับ", "ค่ะ",
  "เป็น", "อยู่", "ที่", "และ", "หรือ", "แต่", "จะ", "ได้",
  "ไว้", "ไป", "ไปที่", "มา", "ว่า", "นี้", "นั้น", "อะไร", "ทำ",
  "มาก", "น้อย", "มิ้ง", "ดี", "ไม่", "มี", "ให้", "กับ",
  "ใน", "บน", "ขึ้น", "ลง", "ใหญ่", "เล็ก", "ใหม่", "เก่า",
  "คน", "งาน", "วัน", "คืน", "ปี", "เรา", "เขา", "เธอ",
  "ฉัน", "ผม", "คุณ", "ใคร", "ยังไง", "ยังไงก็", "อย่างไร",
  "เพราะ", "เนื่องจาก", "ก่อน", "หลัง", "ระหว่าง", "เกี่ยวกับ",
  "ตาม", "ต่อ", "โดย", "จาก", "ถึง", "จน", "ตั้งแต่", "เกือบ",
  "ค่อนข้าง", "คิด", "รู้", "เห็น", "กิน", "ดื่ม", "นอน",
  "ทำงาน", "เรียน", "สอน", "ดู", "ฟัง", "อ่าน", "เขียน", "พูด",
  "เปิด", "ปิด", "สูง", "ต่ำ", "ยาว", "สั้น", "เร็ว", "ช้า",
  "ดีกว่า", "แย่", "ถูก", "ผิด", "จริง", "เท็จ",
  "อย่างไรก็ตาม", "ก่อนอื่น", "สุดท้าย", "อย่างน้อย", "อย่างมาก",
  "แม้ว่า", "ถ้า", "หาก", "ถึงแม้", "เพราะว่า",
  "นั่น", "โน่น", "นี่", "ครับผม", "ขอบคุณ", "ขอโทษ",
  "ไม่เป็นไร", "ได้เลย", "คะ", "จ้ะ", "จ้า", "นะ",
  "นะครับ", "นะคะ", "ใช่", "ไม่ใช่", "อาจ", "ต้อง",
  "ควร", "อยาก", "ต้องการ", "ชอบ", "เกลียด", "กลัว",
  "ดีใจ", "เสียใจ", "รู้สึก", "บางที", "บางครั้ง", "มัก",
  "กำลัง", "เคย", "เพิ่ง", "ยัง", "เกือบจะ", "เพียง",
  "แค่", "มากมาย", "ดีมาก", "แย่มาก", "สวย", "ใหญ่โต",
  "เร็วมาก", "ช้ามาก", "หนัก", "เบา", "หนา", "บาง",
  "กว้าง", "แคบ", "ลึก", "ตื้น", "เต็ม", "ว่าง",
  "เปล่า", "ง่าย", "ยาก", "ร้อน", "หนาว", "สุข",
  "เศร้า", "เสร็จ", "เสรี", "เสริม", "สนุก", "เกม", "ทำเกม", "น่าเบื่อ",
  "น่าสนใจ", "ปลอดภัย", "อันตราย", "สะอาด", "สกปรก",
  "สว่าง", "มืด", "เงียบ", "ดัง", "แข็ง", "นุ่ม",
  "เรียบ", "เปียก", "แห้ง", "หวาน", "ขม", "เค็ม",
  "จืด", "เผ็ด", "เย็น", "อุ่น",
  "พก", "ใบ", "ออก", "รอ", "สัก", "ครึ่ง", "แต่ง", "ตัว", "ใส่",
  "ซึ่ง", "ตน", "ความ", "แนะนำ", "จัดสรร", "สบาย", "พร้อม", "รู้จัก", "ย่าน",
  "แจ่มชัด", "ซึมซับ", "เสน่ห์", "รส", "แท้", "สะดุดตา", "ผนึก", "กระเป๋า", "ผ้า",
  "นาที", "ผ่าน", "ฟ้า", "บริเวณ", "เต็ม", "ตึก", "สูง", "ระฟ้า", "ก้าว", "รุด", "หน้า",
  "จังหวะ", "เร่ง", "รีบ", "เกิน", "เปิด", "ฉ่ำ", "มอบ", "ประสบการณ์", "ซ้ำ", "แตกต่าง", "หา",
  "ทั่ว", "โลก", "ละ", "ตัวตน", "อาหาร", "รส", "สิ่ง", "ก่อสร้าง", "สะดุดตา", "เรื่องราว", "นานัปการ",
  "เขต", "พระนคร", "นำ", "ข้าม", "สำรวจ", "แนว", "กำแพง", "โบราณ", "เหลือ", "เลือก", "เดิน",
  "กว่า", "แห่ง", "มัก", "ตาม", "รูป", "มือ", "ปิด", "ความ", "เมื่อ", "คราว", "หลวง",
  "บรรยากาศ", "สาย", "หลาย", "ทอด", "บรรจบ", "ราว", "ร้อย", "ต้น", "ป้อม", "รับมือ", "ข้าศึก",
  "ยก", "เข้า", "ตี", "ทิศ", "ตะวันออก",
  "ด้วย", "ก็", "อย่าง", "ชม", "มุม",
  "จึง", "ถึง", "ฝูง", "ลง", "สู่", "หนังสือ", "ทักษะ", "ใช้", "แทน", "โอกาส", "ลิ้มรส", "วัง", "ขุนนาง", "หู",
  "น้ำมัน", "เดือด", "พล่าน", "ชวน", "หวาดหวั่น", "เรียกว่า", "คลอง", "รอบ", "กรุง", "สี่", "แยก", "ป้าย", "เด่น", "หรา", "ระบุ",
  "คาเฟ่", "ตกแต่ง", "เก๋", "ย้าย", "นาน", "ตา", "นัก", "อ่าน", "กรุงเทพ", "โอบ", "ล้อม", "ทุก", "ด้าน", "ห่าง", "ทรง", "เทพ",
  "สถาปนา", "ได้รับ", "ผ่านมา", "แทรก", "ตัวอย่าง", "กลมกลืน", "ยุค", "เริ่มต้น", "เข้าใจ", "เยือน", "ภาพรวม", "อดีต", "ด้านหลัง", "บ้านพัก", "ท่ามกลาง", "ร่มรื่น", "ไม่ไกล", "อุทิศ", "ถือเป็น", "แห่งแรก", "ภายใน", "เงียบสงบ", "เต็มอิ่ม", "ออกเดินทาง", "หมู่บ้าน", "เครื่องปั้น", "ดินเผา", "ใจกลาง", "กิโลเมตร", "พิกัด", "แถบ", "ประมาณ", "เสร็จ", "กลับบ้าน", "พลาด", "ตำรับ", "แรงบันดาลใจ", "ภูมิภาค", "วัตถุดิบ", "พิเศษ", "คึกคัก", "เฉพาะตัว", "ด้านล่าง", "ดัดแปลง", "สมัยใหม่", "กิจกรรม", "ตระเวน", "ต้นกำเนิด", "คิดค้น", "แวะ", "ส่วนผสม", "สดชื่น", "คลายร้อน", "โดยเฉพาะ", "สองข้าง", "ขบวน", "ซ่อน", "ตรอก", "ชื่นชอบ", "สัญจร", "ไปมา", "ดื่มด่ำ", "มุ่งหน้า", "ทะเลสาบ", "ไปยัง", "ด้านข้าง", "ทอดผ่าน", "เกาะกลาง", "สูงกว่า", "รูปแบบ", "เติมพลัง", "ร้านดัง", "กินพร้อม", "นานาชนิด", "ผักสด", "ไม่อั้น", "อร่อย", "เต็มไปด้วย", "อาทิ", "ต้นแบบ", "เก็บรวบรวม", "ค้นพบ", "นับหมื่น", "เกิดขึ้น", "สูตร", "ต้นตำรับ", "ลงตัว", "ความอร่อย", "เนื้อนุ่ม", "เครื่องเคียง", "สารพัด", "ให้บริการ",   "ตรง", "วันละ", "เมือง", "สำรอง",
  "การ", "เงิน", "นำเรื่อง", "วาง", "ลี้", "จำนวน", "ประเด็น", "รวดเร็ว", "ตัวละคร", "เผยแพร่", "จุดประสงค์", "วิจัย", "ประกอบด้วย", "หัวเรื่อง", "เนื้อเรื่อง", "สรุป", "แก่นเรื่อง", "หน่วยงาน", "ประสาน", "ดำเนินงาน", "เป้าหมาย", "ฤดูกาล", "จอง", "ล่วงหน้า", "ค่าใช้จ่าย", "สม่ำเสมอ", "แจ่มใส",
  "เด็ก", "ทฤษฎี", "ผลไม้", "ที่สุด", "สุขภาพ", "ความสำคัญ", "รู้เท่าทัน", "โรค", "พัฒนา", "ต่อเนื่อง", "ต้องการ", "รักษา", "เร่งด่วน", "ความสนใจ", "เรียนรู้", "จำเป็น", "อนาคต", "ข่าวสาร", "พักผ่อน", "เพียงพอ", "ขนาด", "เคล็ดลับ", "สิ่งพิมพ์", "อิเล็กทรอนิกส์",
  "ปลัด", "กระทรวง", "สหกรณ์", "ประธาน", "กรรมการ", "บริหาร", "ประชุม", "คณะ", "เยียวยา", "ภาวะ", "หนี้เสีย", "มาตรการ", "วิถี", "เทศกาล", "ธรรมเนียม", "เคารพ", "เอกลักษณ์", "แสดง", "ความเชื่อ", "หน้าที่", "รหัสผ่าน", "ข้อมูล", "ความปลอดภัย", "ปัจจุบัน", "ชีวิตประจำวัน", "ระบบ",
  "จัดจ้าน", "หลากหลาย", "เมนู", "นิยม", "ต่างชาติ", "สดใหม่", "ปรุง", "ถูกวิธี", "ปลอดภัย", "ล้างมือ", "รับประทาน", "วอร์ม", "บาดเจ็บ", "กล้ามเนื้อ", "คลายตัว",
  "สมดุล", "สิ่งแวดล้อม", "รุ่นหลัง", "พลาสติก", "แยกขยะ", "ปลูก", "ต้นไม้", "เลี้ยง", "พืช", "อากาศ", "สงบ", "งานอดิเรก", "ครอบครัว", "หน่วย", "สังคม", "ความสัมพันธ์", "เลี้ยงดู", "เติบโต", "คุณภาพ", "ความรัก", "ความเข้าใจ", "แบบอย่าง", "ลูก",
  "ปีนี้", "แข็งแรง", "จิตใจ", "สวยงาม",
  "ศึกษา", "โทรศัพท์", "พูดคุย", "สั่งการ", "เกษตรกร", "ทุกครั้ง", "สื่อสาร", "เปิดเผย", "รับฟัง", "ความเห็น", "เพื่อนร่วมงาน", "จัดสรรเวลา", "ป้องกัน", "ความเครียด", "ประสิทธิภาพ", "ธุรกิจ", "ขนาดเล็ก", "กำลัง", "เศรษฐกิจ", "สินค้า", "บริการ", "แข่งขัน", "ตลาด", "วิเคราะห์", "ต้นทุน", "รอบคอบ", "ความเสี่ยง", "โอกาส", "ความสำเร็จ", "ลูกค้า", "พึงพอใจ",
  "แผน", "หลัก", "น่าอยู่", "ลด", "ทิ้ง", "ทำสวน", "ท้องถิ่น", "สะท้อน", "รักษา", "ตั้ง", "แชร์", "ที่บ้าน", "ว่ายน้ำ", "วิ่ง", "ยืดเส้น", "ต้มยำ", "ผัดไทย", "ส้มตำ", "ครั้ง", "แยก",
  "เห็น", "หลายคน", "ใช้เวลา", "ร่วมกัน", "เร็วขึ้น", "กลาง", "ทำ", "เพิ่ม", "กล่าว", "แนวทาง", "ทบทวน", "ออกจาก", "อีกครั้ง",
  "สมทบ", "จึงจะ", "หารือ", "ศึกษามาตรการ", "เกิด", "สินไหมทดแทน", "ทุกกรณี", "โครงการ", "ข้าวนาปี", "การผลิต",
  "ที่ได้", "น้ำซุป", "ที่ซับซ้อน", "ที่มีคุณค่า", "ที่เหมาะสม", "ความรับผิดชอบ", "ความทรงจำ", "ข้อพิพาท", "สิทธิ", "หน้าที่", "รัฐธรรมนูญ", "ต้นฉบับ", "บริบท", "สำนวน", "พยากรณ์", "กลางแจ้ง", "อาการ", "ไม่สบาย", "เภสัชกร", "ความเป็นธรรม", "พื้นฐาน", "ไว้ใจ", "ผู้เชี่ยวชาญ", "ภาพยนตร์", "วัดผล", "หัวใจ",
  "เข้าถึง", "ละเมิด", "ลงทุน", "หลีกเลี่ยง", "แพทย์", "ความสงบ", "กฎหมาย", "สร้างความ", "สมอง", "ขั้นตอน",
  "เกี่ยวข้อง", "ขอคำปรึกษา", "ลงนาม", "ทำซ้ำ",
  "ความจำ", "จินตนาการ", "สร้างสรรค์", "ผลงาน", "ความละเอียดอ่อน", "มุมมอง", "แกลเลอรี่", "ประติมากรรม", "ภาพวาด", "ยุคสมัย", "วินัย", "โลกทัศน์", "เล่ม", "สัตวแพทย์", "ฝึกสอน", "อารมณ์",
  "จังหวะ", "ทำนอง", "เครื่องดนตรี", "กีตาร์", "เปียโน", "กลอง", "นิสัย", "นิยาย", "สารคดี", "ประเภท", "บันเทิง",
  "รู้ตัว", "เพื่อ", "ข้อตกลง", "สัญญา",
  "มนุษย์", "อาศัย",
  "หลักฐาน", "จับต้อง", "เนิ่น", "ตรวจ", "แหล่ง",
  "สมมติฐาน", "ตรวจสอบ",
  "ความคาดหวัง", "เหตุผล", "ยอมรับ",
  "ติดตาม", "รสชาติ", "อาย",
  "ไม่ใช่", "ใช่", "ควรจะ",
  "มีการ", "เป็นหัวใจ",
  "อย่างน้อย", "สิ่งที่",
  "ตัวเอง", "คำ",
  "ถอย",
  "มากที่สุด", "ธรรม", "อีก", "หนึ่ง", "ทาง",
  "ลักษณะ", "พฤติกรรม",
  "นโยบาย",
  "ที่ดี",
  "ที่ชอบ", "ที่ยั่งยืน", "ที่ต่อเนื่อง", "ที่แข็งแรง",
  "ที่มีประโยชน์", "ที่หลากหลาย", "ที่ทุกคนทำได้", "ที่น่าอภิรมย์",   "ที่เปลี่ยนแปลงเร็ว",
  "ที่ไม่รู้จัก", "ที่มีความสุข", "ที่เปลี่ยนแปลงได้ดี", "ที่ทุกคนควรปฏิบัติ",   "ที่ทุกคนเข้าถึงได้",
  "มีความรับผิดชอบ", "ดีและจิตใจสงบ",   "ที่สร้างความทรงจำดีๆ",
  "มีคุณภาพชีวิตที่ดี", "ที่ทุกคนควรให้ความสำคัญ", "มีความสวยงามและสมดุล",
  "ทำเมนูใหม่ๆ",
  "มีหลากหลายเมนู",
  "ที่เล็กที่สุดในสังคม",
  "ที่หลายองค์กรนำมาใช้",
  "มีเอกลักษณ์เฉพาะตัว",
];

const wordSet: Set<string> = new Set(embeddedWords);

/** ไม้ยมก (ๆ) — ถ้าต่อท้ายคำ ให้ถือว่าเป็นคำเดียวกัน (งงๆ = งง) */
const THAI_REPETITION_MARK = "\u0E46";

/** ตรวจว่าเป็นคำไทยที่รู้จัก (รองรับคำติดกันไม่มีเว้นวรรค เช่น ไม่เป็น) */
export function containsKnownThai(text: string): boolean {
  const trimmed = text.trim();
  if (!trimmed) return false;

  const tokens = trimmed.split(/\s+/).filter((t) => t.length > 0);
  if (tokens.length === 0) return false;

  return tokens.every((token) => {
    if (wordSet.has(token)) return true;
    if (token.endsWith(THAI_REPETITION_MARK)) {
      const base = token.slice(0, -THAI_REPETITION_MARK.length);
      if (base && wordSet.has(base)) return true;
    }
    // Thai word segmentation: greedy longest-match
    if (canDecomposeIntoKnownWords(token)) return true;
    return false;
  });
}

/** แยกข้อความไทยที่ไม่มีเว้นวรรคเป็นคำที่รู้จัก (dynamic programming, min word len = 2) */
function canDecomposeIntoKnownWords(text: string): boolean {
  const chars = [...text];
  const n = chars.length;
  const minWordLen = 2;
  if (n < minWordLen * 2) return false; // ต้องแยกเป็น 2+ คำ แต่ละคำ >= 2 ตัว

  const maxWordLen = Math.min(n, 20);

  const dp = new Array<boolean>(n + 1).fill(false);
  dp[0] = true;

  for (let i = minWordLen; i <= n; i++) {
    for (let j = i - minWordLen; j >= 0; j--) {
      if (!dp[j]) continue;
      if (i - j > maxWordLen) break;
      if (wordSet.has(chars.slice(j, i).join(""))) {
        dp[i] = true;
        break;
      }
    }
  }

  if (!dp[n]) return false;

  // ต้องมี split point ระหว่างทาง (ไม่ใช่ match ทั้งก้อน)
  for (let mid = minWordLen; mid <= n - minWordLen; mid++) {
    if (dp[mid]) {
      if (decomposeAll(chars.slice(mid), minWordLen, maxWordLen)) {
        return true;
      }
    }
  }
  return false;
}

function decomposeAll(chars: string[], minLen: number, maxLen: number): boolean {
  const n = chars.length;
  if (n < minLen) return false;
  const dp = new Array<boolean>(n + 1).fill(false);
  dp[0] = true;
  for (let i = minLen; i <= n; i++) {
    for (let j = i - minLen; j >= 0; j--) {
      if (!dp[j]) continue;
      if (i - j > maxLen) break;
      if (wordSet.has(chars.slice(j, i).join(""))) {
        dp[i] = true;
        break;
      }
    }
  }
  return dp[n];
}

/** ตรวจว่ามีคำไทยที่ขึ้นต้นด้วย prefix นี้ */
export function hasWordWithPrefix(prefix: string): boolean {
  const p = prefix.trim();
  if ([...p].length < 2) return false;
  for (const word of wordSet) {
    if (word.startsWith(p)) return true;
  }
  return false;
}

/** ตรวจว่าเป็น Thai character (U+0E01–U+0E5B) */
export function isThaiCodePoint(code: number): boolean {
  return code >= 0x0e01 && code <= 0x0e5b;
}
